<?xml version="1.0" encoding="UTF-8"?>
<x:description xmlns:x="http://www.jenitennison.com/xslt/xspec"
               xmlns:html="http://www.w3.org/1999/xhtml"
               xmlns:epub="http://www.idpf.org/2007/ops"
               xmlns="http://www.w3.org/1999/xhtml"
               stylesheet="../../main/resources/xml/pre-processing.xsl">
    
    <x:param name="maximum-number-of-pages" select="5"/>
    
    <x:scenario label="automatically give number to noterefs that are not already numbered">
        <x:context>
            <div>
                <span epub:type="noteref">1</span>
                <span epub:type="noteref">2</span>
                <span epub:type="noteref">3</span>
                <span epub:type="noteref">*</span>
                <span epub:type="noteref">*</span>
                <span epub:type="noteref">*</span>
            </div>
        </x:context>
        
        <x:expect label="result">
            <div>
                <span epub:type="noteref">1</span>
                <span epub:type="noteref">2</span>
                <span epub:type="noteref">3</span>
                <span epub:type="noteref">4</span>
                <span epub:type="noteref">5</span>
                <span epub:type="noteref">6</span>
            </div>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="automatically give number to notes that are not already numbered">
        <x:context>
            <div>
                <aside epub:type="note">
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="footnote">
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="endnote">
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="rearnote">
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
            </div>
        </x:context>
        
        <x:expect label="result">
            <div>
                <aside epub:type="note">
                    <p>1 lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="footnote">
                    <p>2 lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="endnote">
                    <p>3 lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="rearnote">
                    <p>4 lorem ipsum</p>
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
            </div>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="Make sure that notes only contain block content">
        <x:context>
            <div>
                <aside epub:type="note">* lorem ipsum</aside>
                <aside epub:type="footnote">* lorem ipsum
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="endnote">
                    <p>* lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
            </div>
        </x:context>
        
        <x:expect label="result">
            <div>
                <aside epub:type="note">
                    <p>1 lorem ipsum</p>
                </aside>
                <aside epub:type="footnote">
                    <p>2 lorem ipsum
                    </p>
                    <p>* lorem ipsum</p>
                </aside>
                <aside epub:type="endnote">
                    <p>3 lorem ipsum</p>
                    <p>* lorem ipsum</p>
                </aside>
            </div>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="rename sectioning elements to 'section'">
        <x:context>
            <div>
                <section id="a"/>
                <article id="b"/>
                <main id="c"/>
            </div>
        </x:context>
        <x:expect label="result">
            <div>
                <section id="a"/>
                <section epub:type="article" id="b"/>
                <section epub:type="main" id="c"/>
            </div>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="move colophon to backmatter (multiple body elements)">
        <x:context>
            <html>
                <body epub:type="cover"/>
                <body epub:type="frontmatter"/>
                <body epub:type="frontmatter colophon"/>
                <body epub:type="bodymatter"/>
                <body epub:type="backmatter"/>
            </html>
        </x:context>
        <x:expect label="result">
            <html>
                <body epub:type="cover"/>
                <body epub:type="frontmatter"/>
                <body epub:type="bodymatter"/>
                <body epub:type="backmatter"/>
                <body epub:type="colophon backmatter"/>
            </html>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="move colophon to backmatter (single body element)">
        <x:context>
            <body>
                <section epub:type="cover"/>
                <section epub:type="frontmatter"/>
                <section epub:type="frontmatter colophon"/>
                <section epub:type="bodymatter"/>
                <section epub:type="backmatter"/>
            </body>
        </x:context>
        <x:expect label="result">
            <body>
                <section epub:type="cover"/>
                <section epub:type="frontmatter"/>
                <section epub:type="bodymatter"/>
                <section epub:type="backmatter"/>
                <section epub:type="colophon backmatter"/>
            </body>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="remove titlepage and print toc (multiple body elements)">
        <x:context>
            <html>
                <body epub:type="cover"/>
                <body epub:type="titlepage"/>
                <body epub:type="toc"/>
            </html>
        </x:context>
        <x:expect label="result">
            <html>
                <body epub:type="cover"/>
            </html>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="remove titlepage and print toc (single body element)">
        <x:context>
            <body>
                <section epub:type="cover"/>
                <section epub:type="titlepage"/>
                <section epub:type="toc"/>
            </body>
        </x:context>
        <x:expect label="result">
            <body>
                <section epub:type="cover"/>
            </body>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="wrap leaf sections and add classes">
        <x:context>
            <body>
                <h1>Headline 1</h1>
                <p>Paragraph 1.</p>
                <p>Paragraph 2.</p>
                <img src="img1.jpg"/>
                <p>Paragraph 3.</p>
                <section>
                    <h2>Headline 1.1</h2>
                    <p>Paragraph 4.</p>
                    <p>Paragraph 5.</p>
                    <img src="img2.jpg"/>
                    <p>Paragraph 6.</p>
                </section>
                <section>
                    <h2>Headline 1.2</h2>
                    <p>Paragraph 7.</p>
                    <p>Paragraph 8.</p>
                    <img src="img3.jpg"/>
                    <p>Paragraph 9.</p>
                    <section>
                        <h2>Headline 1.2.1</h2>
                        <p>Paragraph 10.</p>
                        <p>Paragraph 11.</p>
                        <img src="img3.jpg"/>
                        <p>Paragraph 12.</p>
                    </section>
                </section>
                <p>Paragraph 13.</p>
                <p>Paragraph 14.</p>
                <section>
                    <h2>Headline 1.3</h2>
                    <p>Paragraph 15.</p>
                    <p>Paragraph 16.</p>
                    <img src="img4.jpg"/>
                    <p>Paragraph 17.</p>
                </section>
                <p>Paragraph 18.</p>
                <p>Paragraph 19.</p>
            </body>
        </x:context>
        <x:expect label="result">
            <body>
                <div class="leaf-section">
                    <h1>Headline 1</h1>
                    <p>Paragraph 1.</p>
                    <p>Paragraph 2.</p>
                    <img src="img1.jpg"/>
                    <p>Paragraph 3.</p>
                </div>
                <section>
                    <h2>Headline 1.1</h2>
                    <p>Paragraph 4.</p>
                    <p>Paragraph 5.</p>
                    <img src="img2.jpg"/>
                    <p>Paragraph 6.</p>
                </section>
                <section>
                    <div class="leaf-section">
                        <h2>Headline 1.2</h2>
                        <p>Paragraph 7.</p>
                        <p>Paragraph 8.</p>
                        <img src="img3.jpg"/>
                        <p>Paragraph 9.</p>
                    </div>
                    <section>
                        <h2>Headline 1.2.1</h2>
                        <p>Paragraph 10.</p>
                        <p>Paragraph 11.</p>
                        <img src="img3.jpg"/>
                        <p>Paragraph 12.</p>
                    </section>
                </section>
                <div class="leaf-section">
                    <p>Paragraph 13.</p>
                    <p>Paragraph 14.</p>
                </div>
                <section>
                    <h2>Headline 1.3</h2>
                    <p>Paragraph 15.</p>
                    <p>Paragraph 16.</p>
                    <img src="img4.jpg"/>
                    <p>Paragraph 17.</p>
                </section>
                <div class="leaf-section">
                    <p>Paragraph 18.</p>
                    <p>Paragraph 19.</p>
                </div>
            </body>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="big and small leaf sections">
        <x:context>
            <body>
                <h1>Headline 1</h1>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                <section>
                    <h2>Headline 1.1</h2>
                    <p>Paragraph 4.</p>
                    <p>Paragraph 5.</p>
                    <img src="img2.jpg"/>
                    <p>Paragraph 6.</p>
                </section>
                <section>
                    <h2>Headline 1.2</h2>
                    <p>Paragraph 7.</p>
                    <p>Paragraph 8.</p>
                    <img src="img3.jpg"/>
                    <p>Paragraph 9.</p>
                    <section>
                        <h2>Headline 1.2.1</h2>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    </section>
                </section>
                <p>Paragraph 13.</p>
                <p>Paragraph 14.</p>
                <section>
                    <h2>Headline 1.3</h2>
                    <p>Paragraph 15.</p>
                    <p>Paragraph 16.</p>
                    <img src="img4.jpg"/>
                    <p>Paragraph 17.</p>
                </section>
                <p>Paragraph 18.</p>
                <p>Paragraph 19.</p>
            </body>
        </x:context>
        <x:expect label="result">
            <body>
                <div class="leaf-section">
                    <h1>Headline 1</h1>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                </div>
                <div class="leaf-section">
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                </div>
                <div class="leaf-section">
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                    <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                        tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                        quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                        consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                        cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                        proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                </div>
                <section>
                    <h2>Headline 1.1</h2>
                    <p>Paragraph 4.</p>
                    <p>Paragraph 5.</p>
                    <img src="img2.jpg"/>
                    <p>Paragraph 6.</p>
                </section>
                <section>
                    <div class="leaf-section">
                        <h2>Headline 1.2</h2>
                        <p>Paragraph 7.</p>
                        <p>Paragraph 8.</p>
                        <img src="img3.jpg"/>
                        <p>Paragraph 9.</p>
                    </div>
                    <section>
                        <div class="leaf-section">
                            <h2>Headline 1.2.1</h2>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        </div>
                        <div class="leaf-section">
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        </div>
                        <div class="leaf-section">
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                            tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                            quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                            consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                            cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
                            proident, sunt in culpa qui officia deserunt mollit anim id est laborum.</p>
                        </div>
                    </section>
                </section>
                <div class="leaf-section">
                    <p>Paragraph 13.</p>
                    <p>Paragraph 14.</p>
                </div>
                <section>
                    <h2>Headline 1.3</h2>
                    <p>Paragraph 15.</p>
                    <p>Paragraph 16.</p>
                    <img src="img4.jpg"/>
                    <p>Paragraph 17.</p>
                </section>
                <div class="leaf-section">
                    <p>Paragraph 18.</p>
                    <p>Paragraph 19.</p>
                </div>
            </body>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="create multiple leaf-nodes to prevent java.lang.RuntimeException: Failed to complete volume division.">
        <x:call template="create-div-leaf-sections">
            <x:param name="maximum-number-of-leaf-section-pages" select="2"/>
            <x:param name="content" select="node()">
                <!-- leaf node: div.leaf-node -->
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
            </x:param>
        </x:call>
        <x:expect label="result">
            <div class="leaf-section">
                <!-- leaf node: div.leaf-node -->
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
            </div>
            <div class="leaf-section">
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
            </div>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="Small section elements without child section elements don't need leaf section divs">
        <x:context mode="leaf-sections">
            <section class="chapter">
                <p>content content content content content content content content content content</p>
            </section>
        </x:context>
        <x:expect label="result">
            <section class="chapter">
                <p>content content content content content content content content content content</p>
            </section>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="Big section elements without child section elements needs leaf section divs">
        <x:context mode="leaf-sections">
            <section class="chapter">
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                
                <!-- 632 characters -->
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
                <p>content content content content content content content content content content</p>
            </section>
        </x:context>
        <x:expect label="result">
            <section class="chapter">
                <div class="leaf-section">
                    <!-- 632 characters -->
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    
                    <!-- 632 characters -->
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                </div>
                <div class="leaf-section">
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    
                    <!-- 632 characters -->
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                    <p>content content content content content content content content content content</p>
                </div>
            </section>
        </x:expect>
    </x:scenario>
    
    <x:scenario label="Definition lists needs to be restructured for CSS styling">
        <x:context>
            <dl>
                <dt>Term 1</dt>
                <dd>Details 1</dd>
                <dt>Term 2.1</dt>
                <dt>Term 2.2</dt>
                <dd>Details 2</dd>
                <dt>Term 3</dt>
                <dd>Details 3.1</dd>
                <dd>Details 3.2</dd>
                <dt>Term 4.1</dt>
                <dt>Term 4.2</dt>
                <dt>Term 4.3</dt>
                <dd>Details 4.1</dd>
                <dd>Details 4.2</dd>
                <dd>Details 4.3</dd>
                <dt>Term 5:</dt>
                <dd>Details 5</dd>
                <dt><span><em>Term 6:</em> </span></dt>
                <dd>Details 6</dd>
            </dl>
        </x:context>
        <x:expect>
            <dl>
                <li>
                    <dt>Term 1: </dt>
                    <dd>Details 1</dd>
                </li>
                <li>
                    <dt>Term 2.1 </dt>
                    <dt>Term 2.2: </dt>
                    <dd>Details 2</dd>
                </li>
                <li>
                    <dt>Term 3: </dt>
                    <dd>Details 3.1</dd>
                    <dd>Details 3.2</dd>
                </li>
                <li>
                    <dt>Term 4.1 </dt>
                    <dt>Term 4.2 </dt>
                    <dt>Term 4.3: </dt>
                    <dd>Details 4.1</dd>
                    <dd>Details 4.2</dd>
                    <dd>Details 4.3</dd>
                </li>
                <li>
                    <dt>Term 5: </dt>
                    <dd>Details 5</dd>
                </li>
                <li>
                    <dt><span><em>Term 6:</em> </span> </dt>
                    <dd>Details 6</dd>
                </li>
            </dl>
        </x:expect>
    </x:scenario>
    
</x:description>
